<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="googlebot" content="NOODP" /><meta name="google-site-verification" content="nSYeDgyKM9mw5CWcZuD0xu7iSWXlJijAlg9rcxVOYf4" /><meta name="google-site-verification" content="6UEaC3SWhpGQvqRnSJIEm2swxXpM5Adn4dxZhFsNdw0" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="viewport" name="viewport" /><link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700" rel="stylesheet" /><link rel="stylesheet" href="/css/rabbit.css" type="text/css" /><link rel="stylesheet" href="/css/highlightjs_style.css" type="text/css" /><!--[if IE 6]>
      <link rel="stylesheet" href="/css/rabbit-ie6.css" type="text/css" />
      <![endif]--><link rel="icon" type="/image/vnd.microsoft.icon" href="/favicon.ico" /><link rel="stylesheet" href="/css/tutorial.css" type="text/css" /><script type="text/javascript" src="/js/site.js"></script><script type="text/javascript" src="/js/ga-bootstrap.js"></script><title>RabbitMQ - Negative Acknowledgements</title>
    
  </head>
  <body id="nack"><div id="outerContainer"><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/RabbitMQ-logo.svg" alt="RabbitMQ" /></a></div><a class="btn menubtn" onclick="showHide()">Menu <img src="/img/carrot-down-white.svg" /></a><div class="mobilemenuicon" onclick="showHide()"><img src="/img/mobile-menu-icon.svg" /></div><div id="nav"><ul id="mainNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li><li><a href="/blog/">Blog</a></li></ul></div></div><div class="nav-separator"></div><div id="innerContainer" class="container"><div id="left-content"><h1>Negative Acknowledgements</h1>
    <p>
      Consumers in AMQP 0-9-1 can choose to use <a href="/confirms.html">manual acknowledgements</a>
      of deliveries.
    </p>
    <p>
      The <a href="/specification.html">AMQP 0-9-1 specification</a> defines the <span class="code ">basic.reject</span>
      method that allows clients to reject individual, delivered
      messages, instructing the broker to either discard them or
      requeue them. Unfortunately, <span class="code ">basic.reject</span>
      provides no support for negatively acknowledging messages in
      bulk.
    </p>

    <p>
      To solve this, RabbitMQ supports the <span class="code ">basic.nack</span>
      method that provides all the functionality of
      <span class="code ">basic.reject</span> whilst also allowing for bulk
      processing of messages.
    </p>

    <p>
      To reject messages in bulk, clients set the
      <span class="code ">multiple</span> flag of the <span class="code ">basic.nack</span>
      method to <span class="code ">true</span>. The broker will then reject all
      unacknowledged, delivered messages up to and including the
      message specified in the <span class="code ">delivery_tag</span> field of
      the <span class="code ">basic.nack</span> method. In this respect,
      <span class="code ">basic.nack</span> complements the bulk acknowledgement
      semantics of <span class="code ">basic.ack</span>.
    </p>

    <p>
      This example rejects a single message, asking the broker to requeue it:

      <pre class="sourcecode java">
GetResponse gr = channel.basicGet("some.queue", false);
channel.basicNack(gr.getEnvelope().getDeliveryTag(), false, true);</pre>
    </p>
    <p>
      This example rejects two messages with a single call to
      the broker (the second argument on
      <span class="code ">basicNack</span> is the <span class="code ">multiple</span> flag):

    <pre class="sourcecode java">
GetResponse gr1 = channel.basicGet("some.queue", false);
GetResponse gr2 = channel.basicGet("some.queue", false);
channel.basicNack(gr2.getEnvelope().getDeliveryTag(), true, true);</pre>
    </p>

    <p>
      When a message is requeued, it will be placed to its original
      position in its queue, if possible. If not (due to concurrent
      deliveries and acknowledgements from other consumers when
      multiple consumers share a queue), the message will be requeued
      to a position closer to queue head.
    </p>
  </div><div id="right-nav"><div id="in-this-section"><h4>In This Section</h4><ul>
     <li><a href="/admin-guide.html">Server Documentation</a></li>
     <li><a href="/clients.html">Client Documentation</a></li>
     <li><a href="/plugins.html">Plugins</a></li>
     <li><a href="/news.html">News</a></li>
     <li><a href="/protocol.html">Protocol</a></li>
     <li><a href="/extensions.html" class="selected">Our Extensions</a><ul>
       <li><a href="/confirms.html">Confirms</a></li>
       <li><a href="/consumer-cancel.html">Consumer Cancel</a></li>
       <li><a href="/consumer-prefetch.html">Consumer Prefetch</a></li>
       <li><a href="/consumer-priority.html">Consumer Priorities</a></li>
       <li><a href="/direct-reply-to.html">Direct reply-to</a></li>
       <li><a href="/connection-blocked.html">Blocked Connections</a></li>
       <li><a href="/nack.html" class="selected">basic.nack</a></li>
       <li><a href="/e2e.html">e2e bindings</a></li>
       <li><a href="/ae.html">Alternate Exchanges</a></li>
       <li><a href="/sender-selected.html">Sender Routing</a></li>
       <li><a href="/ttl.html">TTL</a></li>
       <li><a href="/dlx.html">Dead Lettering</a></li>
       <li><a href="/maxlength.html">Length Limit</a></li>
       <li><a href="/priority.html">Priority Queues</a></li>
       <li><a href="/validated-user-id.html">Validated User ID</a></li>
       <li><a href="/auth-notification.html">Auth Failure</a></li>
       <li><a href="/spec-differences.html">Spec Differences</a></li>
     </ul></li>
     <li><a href="/build.html">Building</a></li>
     
       <li><a href="/previous.html">Previous Releases</a></li>
     
     <li><a href="/mpl.html">License</a></li>
   </ul></div></div></div><div class="clear"></div><div class="pageFooter"><div class="container"><div class="rabbit-logo"><a href="/"><img src="/img/RabbitMQ-logo-white.svg" alt="RabbitMQ" /></a></div><ul class="footerNav"><li><a href="/#features">Features</a></li><li><a href="/#getstarted">Get Started</a></li><li><a href="/#support">Support</a></li><li><a href="/#community">Community</a></li><li><a href="/documentation.html">Docs</a></li><li><a href="/blog/">Blog</a></li></ul><a id="s1p-promo" href="https://springoneplatform.io/?utm_source=rabbitmq&amp;utm_medium=tile-web-banner&amp;utm_campaign=s1p-registration-promo" target="_blank"><img src="/img/banner-s1p.png" /></a><p id="copyright">
          Copyright Â© 2007-Present <a href="https://pivotal.io/">Pivotal Software</a>, Inc. All rights reserved.
          <a href="https://pivotal.io/terms-of-use">Terms of Use</a>,
          <a href="https://pivotal.io/privacy-policy">Privacy</a> and
          <a href="/trademark-guidelines.html">Trademark Guidelines</a></p></div></div></div><script type="text/javascript" src="/js/highlight.pack.js"></script><script type="text/javascript">
        // code highlighting
        onDOMReady(function() {
          document.querySelectorAll(".sourcecode").forEach(function(el) {
            hljs.highlightBlock(el);
          });
        });
      </script></body>
</html>
