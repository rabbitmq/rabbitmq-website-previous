<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="RabbitMQ is a complete and highly reliable enterprise messaging system based on the emerging AMQP standard" /><meta name="googlebot" content="NOODP" /><meta name="google-site-verification" content="nSYeDgyKM9mw5CWcZuD0xu7iSWXlJijAlg9rcxVOYf4" /><meta name="google-site-verification" content="6UEaC3SWhpGQvqRnSJIEm2swxXpM5Adn4dxZhFsNdw0" /><link rel="stylesheet" href="/v3_2_x/css/rabbit.css" type="text/css" /><style xmlns:html="http://www.w3.org/1999/xhtml" xmlns:doc="http://www.rabbitmq.com/namespaces/ad-hoc/doc">
    body { 
    background: 
    url(/v3_2_x/img/previous-bg.png);
   }
  </style><link rel="icon" type="/image/vnd.microsoft.icon" href="/v3_2_x/favicon.ico" /><link rel="stylesheet" href="/v3_2_x/css/tutorial.css" type="text/css" /><script type="text/javascript" src="/v3_2_x/js/site.js"></script><script type="text/javascript" src="/v3_2_x/js/ga-bootstrap.js"></script><title>RabbitMQ - Using Mercurial</title>
    
  </head>
  <body><div id="outerContainer"><div id="rabbit-logo"><a href="/v3_2_x/"><img src="/v3_2_x/img/rabbitmq_logo_strap.png" alt="RabbitMQ" width="253" height="53" /></a></div><div id="pivotal-logo"><a href="http://www.gopivotal.com/"><img src="/v3_2_x/img/logo-pivotal-118x25.png" alt="Pivotal" width="118" height="25" /></a></div><div id="nav-search"><ul class="mainNav"><li><a href="/v3_2_x/features.html">Features</a></li><li><a href="/v3_2_x/download.html">Installation</a></li><li><a href="/v3_2_x/documentation.html" class="selected">Documentation</a></li><li><a href="/v3_2_x/getstarted.html">Tutorials</a></li><li><a href="/v3_2_x/services.html">Services</a></li><li><a href="/v3_2_x/community.html">Community</a></li></ul></div><div class="nav-separator"></div><div id="left-content"><h1>Using Mercurial</h1>
      <p class="intro">
	This page describes the way we work with Mercurial on the
	RabbitMQ project.
      </p>

      <div class="docSection"><a name="overview" id="overview"></a>
	<p>
	  <a href="http://www.selenic.com/mercurial/">Mercurial</a> is
	  a fast, lightweight <a href="http://en.wikipedia.org/wiki/Revision_control">Source
	  Control Management system</a> designed for efficient
	  handling of very large distributed projects.
	</p>
	<p>
	  We use Mercurial on the RabbitMQ project to manage almost
	  all our source-code.
	</p>
	<ul>
	  <li>Mercurial has numerous <a href="http://www.selenic.com/mercurial/wiki/index.cgi/Tutorial">tutorials</a>.</li>

	  <li>RabbitMQ's Mercurial repositories are <a href="http://hg.rabbitmq.com/">listed here</a>. Individual
	  project pages on this website will generally point you in
	  the direction of the specific combinations of modules you'll
	  need to check out.</li>
	</ul>
      </div>

      <div class="docSection"><a name="branchperbug" id="branchperbug"></a>
	<h2 class="docHeading">Branching policy: Branch per bug</h2>
	<p>
	  We use the technique of <i>branch per bug</i> when
	  developing RabbitMQ code, where each feature or bug fix is
	  developed on a branch of its own (using <span class="code ">hg
	  branch</span>) and merged into the <span class="code ">default</span>
	  (trunk) branch only when the hurdle of QA is passed. We use
	  our Bugzilla instance to track each work item, so branches
	  follow the pattern <span class="code ">bug<i>NNNNN</i></span>.
	</p>
	<p>
	  More information on this style of development can be found
	  in the following links:
	</p>
	<ul>
	  <li><a href="http://www.lshift.net/blog/2008/06/19/mercurial-merge-technique">Mercurial
	  Merge Technique</a> on the LShift blog.</li>

	  <li><a href="http://hgbook.red-bean.com/hgbookch8.html#x12-1660008.6">Dealing
	  with multiple named branches in a repository</a> from the
	  Mercurial book.</li>
	</ul>

        <p>
          One consequence of this technique is that it is vital that
          you <b>do not use the 'tip' of repository</b> as the basis
          for any work. The 'tip' points to the last commit, which
          could have happend on any, possibly highly experimental,
          branch. Instead all development work must be based on (the
          tips of) named branches, or tagged revisions.
        </p>

      </div>

      <div class="docSection"><a name="defaultbranch" id="defaultbranch"></a>
	<h2 class="docHeading">The default branch</h2>
	<p>
	  The <span class="code ">default</span> branch contains all the work that
	  has been QA'd so far that is scheduled to appear in the next
	  release. The <span class="code ">default</span> branch of each RabbitMQ
	  repository is usually roughly in sync with the
	  <span class="code ">default</span> branches of the others. Generally, you
	  can track QA'd development work by tracking the
	  <span class="code ">default</span> branches of the RabbitMQ repositories
	  of interest.
	</p>
      </div>

      <div class="docSection"><a name="maintenancebranches" id="maintenancebranches"></a>
	<h2 class="docHeading">Maintenance branches</h2>
	<p>
	  Sometimes we create branches for maintenance work, which are
	  used for bug-fixes for a particular release. An example of
	  this is the <span class="code ">v1_5</span> branch which appears in a
	  number of RabbitMQ repositories. Such branches play the same
	  role as the <span class="code ">default</span> branch except that they
	  carry merged, QA'd code intended for the next bug-fix
	  release rather than the next general release.
	</p>
      </div>

      <div class="docSection"><a name="tags" id="tags"></a>
	<h2 class="docHeading">Tags</h2>
	<p>
	  We also use tags to give names to snapshots of the state of
	  the code. Generally, both the core repositories and the
	  repositories of plugins intended to work with the named
	  snapshot are tagged.
	</p>
	<p>
	  For example, if you are using RabbitMQ server version 1.5.3,
	  then examining the output of <span class="code ">hg tags</span> in a copy
	  of <span class="code ">rabbitmq-stomp</span> gives:
	</p>
	<pre>$ hg tags
tip                               93:9cd7eba4269c
rabbitmq_v1_5_3                   91:5ee5e2c0b64a
rabbitmq_v1_5_1                   65:2eba20816126
rabbitmq_v1_5_0                   60:1a1ff5067bb6
rabbitmq_v1_4_0                   49:71b922193057
Migrated to mercurial             11:a28eea2c2a2b</pre>
	<p>
	  It's important to make sure that all the repositories you
	  are using are on the same tag as each other. Continuing with
	  our example of server version 1.5.3, you could make sure
	  your checkout of <span class="code ">rabbitmq-stomp</span> was at the
	  <span class="code ">rabbitmq_v1_5_3</span> tag by using <span class="code ">hg
	  update</span>:
	</p>
	<pre>hg update rabbitmq_v1_5_3</pre>
	<p>
	  At this point, you could proceed with compiling the plugin
	  as explained in the plugin's documentation.
	</p>
	<p>
	  If there is no specific tag for a repository for the version
	  of the server you are using, try using the newest tag that
	  has the same major and minor version number. For instance,
	  if you were running RabbitMQ server version 1.5.4, but no
	  corresponding tag on <span class="code ">rabbitmq-stomp</span> was
	  available, you should try using tag
	  <span class="code ">rabbitmq_v1_5_3</span>. Another alternative for this
	  hypothetical situation would be to use the tip of the 1.5.x
	  branch:
	</p>
	<pre>$ hg branches
default                        93:9cd7eba4269c
rabbitmq_v1_3_0_branch         45:90dd1726fe0b
v1_5                           92:0ba97fbaea1f (inactive)
$ hg update v1_5
4 files updated, 0 files merged, 5 files removed, 0 files unresolved
$ </pre>
      </div>
  </div><div id="right-nav"><div id="in-this-section"><h4>In This Section</h4><ul>
     <li><a href="/v3_2_x/admin-guide.html">Server Documentation</a></li>
     <li><a href="/v3_2_x/clients.html">Client Documentation</a></li>
     <li><a href="/v3_2_x/plugins.html">Plugins</a></li>
     <li><a href="/v3_2_x/news.html">News</a></li>
     <li><a href="/v3_2_x/protocol.html">Protocol</a></li>
     <li><a href="/v3_2_x/extensions.html">Our Extensions</a></li>
     <li><a href="/v3_2_x/build.html" class="selected">Building</a><ul>
       <li><a href="/v3_2_x/build-server.html">Building the Server</a></li>
       <li><a href="/v3_2_x/build-java-client.html">Building the Java Client</a></li>
       <li><a href="/v3_2_x/build-dotnet-client.html">Building the .NET Client</a></li>
       <li><a href="/v3_2_x/build-erlang-client.html">Building the Erlang Client</a></li>
       <li><a href="/v3_2_x/mercurial.html" class="selected">Our use of Mercurial</a></li>
       
     </ul></li>
     
     <li><a href="/v3_2_x/mpl.html">License</a></li>
   </ul></div></div><div class="clear"></div><div class="pageFooter"><p class="righter"><a href="/v3_2_x/sitemap.html">Sitemap</a> |
        <a href="/v3_2_x/contact.html">Contact</a></p><p id="copyright">
        Copyright © 2014 Pivotal Software, Inc. All rights reserved
        | <a href="http://www.gopivotal.com/privacy-policy">Privacy Policy</a></p></div></div></body>
</html>
